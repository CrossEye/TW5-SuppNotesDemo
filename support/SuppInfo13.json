[{"created":"20251110234012768","text":"/*\\\ntitle: $:/supp-info/core/modules/filters/jsondelete.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for deleting JSON value at indexed path\n\n\\*/\n\n\"use strict\";\n\nexports[\"jsondelete\"] = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar data = $tw.utils.parseJSONSafe(title,title);\n\t\tif(data) {\n\t\t\tconst res = deepDelete(operator.operands)(data);\n\t\t\tresults.push(JSON.stringify(res));\n\t\t}\n\t});\n\treturn results;\n};\n\nconst deepDelete = ([first, ...rest] = []) => (obj, \n\tp = Number(first), \n\ta = p >= 0 ? p : Array.isArray(obj) && Math.max(0, obj.length + p), \n) => \n\tfirst == undefined \n\t\t? obj\n\t\t: Array.isArray(obj)\n\t\t\t? rest.length == 0\n\t\t\t\t? [...obj.slice(0, a), ...obj.slice(a + 1)]\n\t\t\t\t: [...obj.slice(0, a), deepDelete(rest)(obj[a]), ...obj.slice(a + 1)]\n\t\t\t: rest.length == 0\n\t\t\t\t? Object.fromEntries (Object.entries(obj).filter(([k, v]) => k !== first))\n\t\t\t\t: Object.fromEntries(Object.entries(obj).map(\n\t\t\t\t\t([k, v]) => (k == first) ? [k, deepDelete(rest)(v)] : [k, v]\n\t\t  \t\t))","tags":"","title":"$:/supp-info/core/modules/filters/jsondelete.js","modified":"20251110234231934","type":"application/javascript","module-type":"filteroperator"},{"created":"20251107151758434","text":"{\n  \"HelloThere\": [\n    \"My very first note.\\n\\nLook ma, multiple lines!\",\n    \"Another note, just to prove I can.\",\n    \"Dummy text\"\n  ],\n  \"Quick Start\": [\n    \"And a note on another tiddler, with a [[link|Hard and Soft Links]] just for demo.\"\n  ]\n}","tags":"$:/tags/SupplementaryInfo","title":"$:/supp-info/notes/content","modified":"20251111000119326","type":"application/json"},{"created":"20251107152410791","text":"\\procedure add-note()\n  <$let count={{{ [{$:/supp-info/notes/content}jsonindexes<currentTiddler>last[]add[1]] }}}>\n    <$action-setfield \n      $tiddler=\"$:/supp-info/notes/content\"\n      $value={{{ [{$:/supp-info/notes/content}jsonset<currentTiddler>,<count>,[Dummy text]format:json[2]] }}} \n    />\n  </$let>\n\\end add-note\n\n\\procedure delete-note(index)\n  <$action-setfield \n    $tiddler=\"$:/supp-info/notes/content\"\n    $value={{{ [{$:/supp-info/notes/content}jsondelete<currentTiddler>,<index>format:json[2]] }}} \n  />\n</$let>\n\\end delete-note\n\n<% if [{$:/supp-info/notes/content}jsonget<currentTiddler>] %>\n<div class=\"supp-notes\">\n<$let count={{{ [{$:/supp-info/notes/content}jsonindexes<currentTiddler>last[]add[1]] }}}>\n\n<details open>\n  <summary>\n    <<count>> Note(s)  \n    <span class=\"controls\">\n      <$button actions=\"<<add-note>>\" ><span class=\"icon\">{{$:/core/images/new-button}}</span></$button>\n    </span>\n  </summary>\n  <div class=\"note-list\">\n    <$list filter=\"[{$:/supp-info/notes/content}jsonindexes<currentTiddler>]\" variable=\"index\">\n      <div class=\"note-row\">\n        <$button actions=`<<delete-note $(index)$>>` ><span class=\"icon\">{{$:/core/images/delete-button}}</span></$button>\n        <$button actions=`<<>>` ><span class=\"icon\">{{$:/core/images/edit-button}}</span></$button>\n        <div class=\"note\">\n          <$wikify name=\"note\" text={{{ [{$:/supp-info/notes/content}jsonget<currentTiddler>,<index>] }}} output=\"html\"><<note>></$wikify>\n        </div>\n      </div>\n    </$list>\n  </div>\n</details>\n\n</$let>\n</div>\n\n<style>\n.supp-notes {\n  div.debug {background: red; color: white; font-weight: bold; font-size: 150%;}\n  background-color: #ffc;\n  margin-top: 3em;\n  padding: 0;\n  .controls {\n    display: inline-block;\n    margin-left: 1em;\n    svg {width: 1em; height: 1em; vertical-align: middle;}\n  }\n  summary {background-color: #996; color: white; padding: .5em; font-weight: bold;}\n  .note-row {\n    display: flex; \n    flex-direction: row; \n    gap: .75em;\n    align-items: center;\n    padding: .5em;\n    &button {\n      flex: 0 1 auto;\n      width: 2em;\n      svg {width: 1.5em; height: 1em; vertical-align: middle;}    }\n    div.note {flex: 1 0 auto;}\n  }\n  .note {border: 1px solid #ccc; padding: .25em .5em; margin-top: .5em; &>:first-child {margin-top: 0;}}\n}\n</style\n<% endif %>","tags":"$:/tags/ViewTemplate","title":"$:/supp-info/notes/view-template","modified":"20251111001809867"}]