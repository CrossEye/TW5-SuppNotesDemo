[{"created":"20251110234012768","text":"/*\\\ntitle: $:/supp-info/core/modules/filters/jsondelete.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for deleting JSON value at indexed path\n\n\\*/\n\n\"use strict\";\n\nexports[\"jsondelete\"] = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar data = $tw.utils.parseJSONSafe(title,title);\n\t\tif(data) {\n\t\t\tconst res = deepDelete(operator.operands)(data);\n\t\t\tresults.push(JSON.stringify(res));\n\t\t}\n\t});\n\treturn results;\n};\n\nconst deepDelete = ([first, ...rest] = []) => (obj, \n\tp = Number(first), \n\ta = p >= 0 ? p : Array.isArray(obj) && Math.max(0, obj.length + p), \n) => \n\tfirst == undefined \n\t\t? obj\n\t\t: Array.isArray(obj)\n\t\t\t? rest.length == 0\n\t\t\t\t? [...obj.slice(0, a), ...obj.slice(a + 1)]\n\t\t\t\t: [...obj.slice(0, a), deepDelete(rest)(obj[a]), ...obj.slice(a + 1)]\n\t\t\t: rest.length == 0\n\t\t\t\t? Object.fromEntries (Object.entries(obj).filter(([k, v]) => k !== first))\n\t\t\t\t: Object.fromEntries(Object.entries(obj).map(\n\t\t\t\t\t([k, v]) => (k == first) ? [k, deepDelete(rest)(v)] : [k, v]\n\t\t  \t\t))","tags":"","title":"$:/supp-info/core/modules/filters/jsondelete.js","modified":"20251115161940178","type":"application/javascript","module-type":"filteroperator","caption":"jsondelete"},{"created":"20251113195712539","text":"----------\n<<list-links \"[prefix[$:/supp-info]]\">>\n\n----------\n<<list-links \"HelloThere [[Quick Start]] [[Find Out More]]\">>\n\n----------\n<<list-links \"[prefix[$:/temp/supp-info]]\">>\n\n----------\n<<list-links \"$:/AdvancedSearch\" >>","tags":"$:/tags/SideBar","title":"$:/supp-info/core/sidebar/supp-info","modified":"20251115171220091","caption":"Supp"},{"created":"20251107151758434","text":"{\n  \"HelloThere\": [\n    \"My very first note.\\n\\nLook ma, multiple lines!\",\n    \"Another note, just to prove I can.\",\n    \"Dummy text\"\n  ],\n  \"Quick Start\": [\n    \"And a note on another tiddler, with a [[link|Hard and Soft Links]] just for demo.\"\n  ]\n}","tags":"$:/tags/SupplementaryInfo","title":"$:/supp-info/notes/content","modified":"20251117043731647","type":"application/json","caption":"Supp Notes Content"},{"created":"20251115161726500","text":".supp-notes {\n  div.debug {background: red; color: white; font-weight: bold; font-size: 150%;}\n  background-color: #ffc;\n  margin-top: 3em;\n  padding: 0;\n  .controls {\n    display: inline-block;\n    margin-left: 1em;\n    svg {width: 1em; height: 1em; vertical-align: middle;}\n  }\n  summary, .summary, .summary button.toggle {background-color: #996; color: white; padding: .5em; font-weight: bold;}\n  .note-row {\n    display: flex; \n    flex-direction: row; \n    gap: .75em;\n    align-items: center;\n    padding: .5em;\n    &button {\n      flex: 0 1 auto;\n      width: 2em;\n      svg {width: 1.5em; height: 1em; vertical-align: middle;}\n    }\n    textarea {width: 100%;}\n    div.note {flex: 1 0 auto;}\n  }\n  .note {border: 1px solid #ccc; padding: .25em .5em; margin-top: .5em; &>:first-child {margin-top: 0;}}\n}\n","tags":"$:/tags/Stylesheet","title":"$:/supp-info/notes/styles/main","modified":"20251117041637033","type":"text/css","caption":"Supp Notes Stylesheet"},{"created":"20251107152410791","text":"\\procedure add-note()\n  <$let count={{{ [{$:/supp-info/notes/content}jsonindexes<currentTiddler>last[]add[1]] }}}>\n    <$action-setfield \n      $tiddler=\"$:/supp-info/notes/content\"\n      $value={{{ [{$:/supp-info/notes/content}jsonset<currentTiddler>,<count>,[Dummy text]format:json[2]] }}} \n    />\n    <$action-setfield $tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$` $field=\"state\" $value=\"show\" />\n    <$action-setfield $tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` $field=\"mode\" $value=\"edit\" />\n  </$let>\n\\end add-note\n\n\\procedure delete-note(index)\n  <$action-setfield \n    $tiddler=\"$:/supp-info/notes/content\"\n    $value={{{ [{$:/supp-info/notes/content}jsondelete<currentTiddler>,<index>format:json[2]] }}} \n  />\n\\end delete-note\n\n\\procedure edit-note(index)\n  <$action-setfield $tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` $field=\"mode\" $value=\"save\" />\n  <$let \n    temp=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` \n    text={{{ [<temp>get[text]] }}} \n    json={{{ [{$:/supp-info/notes/content}jsonset<currentTiddler>,<index>,<text>format:json[2]] }}}\n  >\n    <$action-setfield $tiddler=\"$:/supp-info/notes/content\" $field=\"text\" $value=<<json>> />\n  </$let>\n\\end edit-note\n\n\\procedure save-note(index)\n  <$action-setfield $tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` $field=\"mode\" $value=\"edit\" />\n  <$action-setfield \n    $tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$`\n    $field=\"text\"\n    $value={{{ [{$:/supp-info/notes/content}jsonget<currentTiddler>,<index>] }}} \n  />\n\\end save-note\n\n<% if [{$:/supp-info/notes/content}jsonget<currentTiddler>] %>\n<div class=\"supp-notes\">\n<$let count={{{ [{$:/supp-info/notes/content}jsonindexes<currentTiddler>last[]add[1]] }}}>\n\n\n<div class=\"summary\">\n  <$button class=\"tc-btn-invisible toggle\" set=`$:/temp/supp-info/notes/$(currentTiddler)$!!state` setTo={{{ [<currentTiddler>addprefix[$:/temp/supp-info/notes/]get[state]toggle[show],[]] }}}>\n     <$let arrow={{{ [<currentTiddler>addprefix[$:/temp/supp-info/notes/]get[state]match[show]then[▽]else[▷]] }}}><<arrow>></$let>\n     <<count>> Note<% if [<count>!match[1]] %>s<% endif %>\n  </$button>\n  <span class=\"controls\">\n    <$button actions=\"<<add-note>>\" ><span class=\"icon\">{{$:/core/images/new-button}}</span></$button>\n  </span>\n</div>\n<$reveal state=`$:/temp/supp-info/notes/$(currentTiddler)$!!state` type=\"match\" text=\"show\" tag=div>\n  <div class=\"note-list\">\n    <$list filter=\"[{$:/supp-info/notes/content}jsonindexes<currentTiddler>]\" variable=\"index\">\n      <div class=\"note-row\">\n        <$let toggle=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` mode={{{ [<toggle>get[mode]] }}} >\n          <$button actions=`<<delete-note $(index)$>>` ><span class=\"icon\">{{$:/core/images/delete-button}}</span></$button>\n          <% if [<mode>match[edit]] %>\n            <$button actions=`<<edit-note $(index)$>>` ><span class=\"icon\">{{$:/core/images/save-button}}</span></$button>\n          <% else %>\n            <$button actions=`<<save-note $(index)$>>` ><span class=\"icon\">{{$:/core/images/edit-button}}</span></$button>\n          <% endif %>\n          <div class=\"note\">\n             <% if [<mode>match[edit]] %>\n              <$edit-text tiddler=`$:/temp/supp-info/notes/$(currentTiddler)$/$(index)$` tag=\"textarea\" field=\"text\" />\n            <% else %>\n              <$wikify name=\"note\" text={{{ [{$:/supp-info/notes/content}jsonget<currentTiddler>,<index>] }}} output=\"html\">\n                <<note>>\n              </$wikify>\n            <% endif %>\n          </div>\n        </$let>\n      </div>\n    </$list>\n  </div>\n</$reveal>\n\n</$let>\n</div>\n\n<% endif %>","tags":"$:/tags/ViewTemplate","title":"$:/supp-info/notes/view-template","modified":"20251117044242134","caption":"Supp Notes Template","query":"[prefix[$:/supp-info]]"}]